{% extends "main.html" %}
{% load static %}

{% block body %}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6 border p-1 rounded">

           {% if messages %}
                <script>
                document.addEventListener('DOMContentLoaded', () => {
                {% for message in messages %}
                    liveToast('bg-{{ message.tags|default:"primary" }}', '{{ message|escapejs }}');
                {% endfor %}
                });
                </script>
           {% endif %}

            <h2 class="text-center mb-4">üìù Tarefa</h2>
            <form method="post" id="form_task" action="{% url 'task:task_add' %}">
                {% csrf_token %}

                <input type="hidden" name="id" value="{{task_data.id|default_if_none:''}}">

                <div class="mb-3">
                    <label for="id_clinica" class="form-label">ID da Cl√≠nica:</label>
                    <input type="number" class="form-control" id="id_clinica" name="id_clinica" required
                        value="{{ task_data.id_clinica|default_if_none:'' }}">
                    <div class="form-text">Coloque 1 caso a requisi√ß√£o seja de sua autoria.</div>
                </div>

                <div class="mb-3">
                    <label for="tipo" class="form-label">Tipo:</label>
                    <select class="form-select" id="tipo" name="tipo" required>
                        <option value="" disabled {% if not task_data.tipo %}selected{% endif %}>Selecione um tipo</option>
                        <option value="Bug" {% if task_data.tipo == "Bug" %}selected{% endif %}>Bug</option>
                        <option value="Melhoria" {% if task_data.tipo == "Melhoria" %}selected{% endif %}>Melhoria</option>
                        <option value="Nova Funcionalidade" {% if task_data.tipo == "Nova Funcionalidade" %}selected{% endif %}>Nova Funcionalidade</option>
                        <option value="Outro" {% if task_data.tipo == "Outro" %}selected{% endif %}>Outro</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="prioridade" class="form-label">Prioridade:</label>
                    <select class="form-select" id="prioridade" name="prioridade" required>
                        <option value="" disabled {% if not task_data.prioridade %}selected{% endif %}>Selecione uma prioridade</option>
                        <option value="4" {% if task_data.prioridade == "4" %}selected{% endif %}>4-‚ùÑÔ∏è Baixa</option>
                        <option value="3" {% if task_data.prioridade == "3" %}selected{% endif %}>3-üòê M√©dia</option>
                        <option value="2" {% if task_data.prioridade == "2" %}selected{% endif %}>2-‚ö†Ô∏è Alta</option>
                        <option value="1" {% if task_data.prioridade == "1" %}selected{% endif %}>1-üî• Cr√≠tica</option>
                    </select>
                </div>

                <script>
                    document.getElementById("prioridade").value = "{{ task_data.prioridade }}";
                </script>

                 <div class="mb-3">
                    <label for="situacao" class="form-label">Situa√ß√£o:</label>
                    <select class="form-select" id="situacao" name="situacao" required>
                        <option value="" disabled {% if not task_data.prioridade %}selected{% endif %}>Selecione uma situa√ß√£o</option>
                        <option value="Aberto">Aberto</option>
                        <option value="Desenvolvendo">Desenvolvendo</option>
                        <option value="Encerrado">Encerrado</option>                     
                    </select>
                </div>

                <script>
                    document.getElementById("situacao").value = "{{ task_data.situacao }}";                    
                </script>



                <div class="mb-3">
                    <label for="caminho" class="form-label">Caminho:</label>
                    <input type="text" class="form-control" id="caminho" name="caminho" maxlength="200" required
                        value="{{ task_data.caminho|default_if_none:'' }}">
                    <div class="form-text">Informe o caminho que o programador deve seguir para encontrar o erro.</div>
                </div>

                <div class="mb-3">
                    <label for="dev" class="form-label">Executor:</label>
                    <select name="dev" id="dev" class="form-select">                        
                    {% for dev in devs %}
                        <option value={{dev.id}}>{{ dev.name }}</option>                                                
                    {% endfor %}
                    </select>                
                    <div class="form-text">Informe o nome de quem vai executar a tarefa.</div>
                </div>          
                
                 <script>
                    document.getElementById("dev").value = "{{ task_data.cod_dev }}";
                </script>


                <div class="mb-3">
                    <label for="descricao" class="form-label">Descri√ß√£o:</label>
                    <textarea class="form-control" id="descricao" name="descricao" required>{{ task_data.descricao|default_if_none:'' }}</textarea>
                    <div class="form-text">A descri√ß√£o precisa ter ao menos 15 letras.</div>
                </div>

                <button type="submit" class="btn btn-primary w-100">Enviar</button>
            </form>
        </div>
    </div>
</div>
<br><br><br><br><br><br><br><br>

{% endblock %}
